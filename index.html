<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Ampel-Prototyp â€“ Side by Side mit Hilfe-Box im Fluss</title>
<style>
  body { font-family: sans-serif; padding:20px; line-height:1.6; }
  .side-by-side { display:flex; gap:20px; }
  .editable { flex:1; border:2px solid #ccc; border-radius:8px; padding:12px; min-height:300px; background:#fafafa; }
  .editable:focus { outline:none; border-color:#228b22; background:#fff; }

   /* Ampel-Badges */
  .ampel-badges { margin-bottom: 8px; }
  .badge {
    border: none; color: white; padding: 0.5rem 1rem; margin: 0.25rem;
    border-radius: 6px; cursor: pointer; font-weight: 600;
  }
  .badge.gruen { background: #228b22; }
  .badge.gelb  { background: #ffd700; }
  .badge.rot   { background: #c62828; }

  h4 { display:flex; align-items:center; gap:8px; margin-top:0; }
  .overall-badge { padding:4px 8px; border-radius:6px; font-weight:bold; }
  .overall-badge.gruen { background:#228b22; color:white; }
  .overall-badge.gelb  { background:#ffd700; color:black; }
  .overall-badge.rot   { background:#c62828; color:white; }

  .mark { cursor:pointer; padding:2px; border-radius:3px; }
  .mark.gruen { background:#e6ffe6; border-bottom:2px solid #228b22; }
  .mark.gelb  { background:#ffffe0; border-bottom:2px dashed #ffd700; }
  .mark.rot   { background:#ffe6e6; border-bottom:2px dashed #c62828; }

  /* Overlays */
  .overlay-box {
    background: #f9f9f9; border-left: 6px solid; padding: 1rem; border-radius: 8px;
    max-width: 720px; margin: 0.75rem 0;
  }
  #overlay-gruen { border-color: #228b22; }
  #overlay-gelb  { border-color: #ffd700; }
  #overlay-rot   { border-color: #c62828; }
  .hidden { display: none; }

  /* Hilfe-Box */
  .help-box {
    position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
    background: #fff; border: 2px solid #ccc; padding: 1rem; border-radius: 12px;
    max-width: 640px; box-shadow: 0 8px 24px rgba(0,0,0,0.18); z-index: 1000;
  }
  .help-box-header { display:flex; justify-content:space-between; align-items:center; }
  .help-box .close { cursor: pointer; font-size: 20px; font-weight: bold; line-height: 1; }
  .help-box button {
    margin-top: 0.5rem; padding: 0.4rem 0.8rem; border: none; border-radius: 4px; background: #eee; cursor: pointer;
  }
  .help-box button:hover { background: #ddd; }

  .tooltip {
  position: relative;
}
.tooltip::after {
  content: attr(data-tooltip);   /* Holt den Text aus data-tooltip */
  position: absolute;
  bottom: 125%;                  /* Ã¼ber der Badge */
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: #fff;
  padding: 6px 8px;
  border-radius: 4px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
  z-index: 1000;
}
.tooltip:hover::after,
.tooltip.show::after {           /* bei Hover oder Klick sichtbar */
  opacity: 1;
}
</style>
</head>
<body>

<!-- Ampelsteuerung und Overlays -->
<div class="section">
  <div class="ampel-badges">
    <button class="badge gruen" onclick="openOverlay('gruen')">ðŸŸ¢ Sicher</button>
    <button class="badge gelb" onclick="openOverlay('gelb')">ðŸŸ¡ Unsicher</button>
    <button class="badge rot" onclick="openOverlay('rot')">ðŸ”´ Riskant</button>
  </div>

  <div id="overlay-gruen" class="overlay-box hidden">
    <h3>ðŸŸ¢ Ãœbersetzung â€“ VerlÃ¤sslich</h3>
    <p>Ãœbersetzung ist verlÃ¤sslich. Sie kÃ¶nnen den Text direkt verwenden.</p>
  </div>

  <div id="overlay-gelb" class="overlay-box hidden">
    <h3>ðŸŸ¡ Ãœbersetzung â€“ VerbesserungsbedÃ¼rftig</h3>
    <p>Ãœbersetzung ist verstÃ¤ndlich, aber nicht perfekt. Mit Vorsicht verwenden â€“ bei wichtigen Inhalten professionelle Hilfe empfohlen.</p>
  </div>

  <div id="overlay-rot" class="overlay-box hidden">
    <h3>ðŸ”´ Ãœbersetzung â€“ Nicht vertrauenswÃ¼rdig</h3>
    <p><strong>QualitÃ¤tseinschÃ¤tzung:</strong> Niedrig</p>
    <p><strong>Risiko:</strong> Hoch (falsche Bedeutungen, unprofessionelle TonalitÃ¤t)</p>
    <p><strong>Empfehlung fÃ¼r Laien:</strong> FÃ¼r wichtige Inhalte bitte nicht verwenden; fÃ¼r grobe Orientierung nur mit Vorsicht.</p>
  </div>
</div>

<div class="side-by-side">
  <!-- Ausgangstext -->
  <div id="source-pane" class="editable" contenteditable="true">
    <h4>Ausgangstext</h4>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor.<br><br>
    Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi.
  </div>

  <!-- Zieltext -->
  <div id="target-pane" class="editable" contenteditable="true">
    <h4>Zieltext 
      <span id="overall-score" 
      class="overall-badge rot tooltip" 
      data-tooltip="Die GesamteinschÃ¤tzung fasst alle Segmentbewertungen zusammen.">
  GesamteinschÃ¤tzung: ðŸ”´ Riskant
</span>
    </h4>
    Lorem ipsum <span class="mark gruen" data-key="l1">dolor sit amet</span>, 
    <span class="mark gelb" data-key="l2">consectetur adipiscing</span> elit, 
    <span class="mark rot" data-key="l3">sed do eiusmod</span> tempor incididunt.<br><br>
    Ut enim ad minim veniam, <span class="mark gelb" data-key="l4">quis nostrud exercitation</span> ullamco laboris nisi ut aliquip ex ea commodo consequat.<br><br>
    Duis aute irure <span class="mark rot" data-key="l5">dolor in reprehenderit</span> in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
  </div>
</div>

<script>
function openOverlay(level) {
  document.querySelectorAll('.overlay-box').forEach(o => o.classList.add('hidden'));
  document.getElementById('overlay-'+level).classList.remove('hidden');
}

function calculateOverallScore() {
  const marks = document.querySelectorAll('.mark');
  let score=0,total=0;
  marks.forEach(m=>{
    total++;
    if(m.classList.contains('gelb')) score+=1;
    if(m.classList.contains('rot')) score+=3;
  });
  const badge=document.getElementById('overall-score');
  badge.classList.remove('gruen','gelb','rot');
  if(score===0){ badge.textContent="GesamteinschÃ¤tzung: ðŸŸ¢ Sicher"; badge.classList.add('gruen'); openOverlay('gruen'); }
  else if(score<=Math.max(2,Math.round(0.25*total))){ badge.textContent="GesamteinschÃ¤tzung: ðŸŸ¡ Unsicher"; badge.classList.add('gelb'); openOverlay('gelb'); }
  else { badge.textContent="GesamteinschÃ¤tzung: ðŸ”´ Riskant"; badge.classList.add('rot'); openOverlay('rot'); }
}

document.addEventListener('DOMContentLoaded',()=>{
  const badge=document.getElementById('overall-score');
  badge.addEventListener('click',()=>{
    badge.classList.toggle('show'); // Tooltip sichtbar/unsichtbar
  });
});

document.addEventListener('DOMContentLoaded',()=>{
  calculateOverallScore();
  const backTranslations={l1:"dolor sit amet",l2:"consectetur adipiscing",l3:"sed do eiusmod",l4:"quis nostrud exercitation",l5:"dolor in reprehenderit"};
  const suggestions={l2:"stilistisch besser",l3:"korrektes Wort",l4:"prÃ¤ziser Ausdruck",l5:"richtige Bedeutung"};

  document.querySelectorAll('.mark').forEach(mark=>{
    mark.addEventListener('click',()=>{
      // alte Hilfe-Box entfernen
      document.querySelectorAll('.help-box').forEach(box=>box.remove());
      // neue Hilfe-Box direkt nach der Markierung einfÃ¼gen
      const helpBox=document.createElement('div');
      helpBox.className='help-box';
      helpBox.innerHTML=`
        <div class="help-box-header">
          <h4>Stelle: ${mark.textContent}</h4>
          <span class="close">Ã—</span>
        </div>
        <p></p>
        <div></div>
      `;
      const helpProblem=helpBox.querySelector('p');
      const helpSuggestions=helpBox.querySelector('div:last-child');
      if(mark.classList.contains('gruen')){
        helpProblem.textContent="ðŸŸ¢ Keine Probleme.";
        helpSuggestions.innerHTML=`<div><strong>RÃ¼ckÃ¼bersetzung:</strong> ${backTranslations[mark.dataset.key]}</div>`;
      } else {
        helpProblem.textContent= mark.classList.contains('gelb') ? "ðŸŸ¡ Leicht verbesserbar." : "ðŸ”´ Bedeutungsfehler.";
        helpSuggestions.innerHTML=`
          <div><strong>RÃ¼ckÃ¼bersetzung:</strong> ${backTranslations[mark.dataset.key]}</div>
          <div><strong>Vorschlag:</strong> ${suggestions[mark.dataset.key]}</div>
        `;
        const btn=document.createElement('button');
        btn.textContent="âœ… Vorschlag Ã¼bernehmen";
        btn.onclick=()=>{ mark.textContent=suggestions[mark.dataset.key]; mark.classList.remove('gelb','rot'); mark.classList.add('gruen'); calculateOverallScore(); helpBox.remove(); };
        helpSuggestions.appendChild(btn);
      }
      helpBox.querySelector('.close').onclick=()=>helpBox.remove();
      mark.insertAdjacentElement('afterend',helpBox);
    });
  });
});
</script>
</body>
</html>